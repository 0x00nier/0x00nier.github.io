<script>
// ============================================
// LEVEL 6: FINAL BOSS - Temple of the Machine God
// HolyC + TempleOS + Divine Computation
// ============================================

const TEMPLE_COMMANDS = {
  'GodSays': 'Query the divine random oracle',
  'Print': 'Print text to console',
  'Cd': 'Change directory',
  'Dir': 'List directory contents',
  'Ed': 'Edit file',
  'Compile': 'Compile HolyC code'
};

const HOLYC_TEMPLATES = {
  hello: `// Hello, God!
U0 Main()
{
  "Hello from TempleOS!\\n";
}

Main;`,

  divine_math: `// Divine Mathematics
I64 Factorial(I64 n)
{
  if (n <= 1) return 1;
  return n * Factorial(n - 1);
}

U0 Main()
{
  I64 i;
  for (i = 1; i <= 10; i++)
    Print("Factorial(%d) = %d\\n", i, Factorial(i));
}

Main;`,

  final_key: `// The Final Key
// This program reveals the divine truth
// But only if you understand the sacred numbers

#define SACRED_A 0x47
#define SACRED_B 0x4F
#define SACRED_C 0x44

U0 RevealTruth()
{
  U8 key[4];
  key[0] = SACRED_A;  // ?
  key[1] = SACRED_B;  // ?
  key[2] = SACRED_C;  // ?
  key[3] = 0;

  Print("The divine speaks: %s\\n", key);

  // The true key is hidden in God's words
  // GodSays will guide you
  // Combine the first letter of each word
  // That is your passphrase
}

RevealTruth;`
};

async function initLevel6() {
  gameState.levelState = {
    // Temple Phase
    enteredTemple: false,
    bootedTempleOS: false,
    learnedHolyC: false,

    // Divine Quest
    queriedOracle: false,
    oracleResponses: [],
    foundSacredNumbers: false,
    decodedMessage: false,

    // Programming Challenge
    wroteCode: false,
    compiledCode: false,
    ranProgram: false,

    // Transcendence
    foundDivineKey: false,
    spokeToGod: false,
    achievedEnlightenment: false,

    // State
    currentDir: '/Home',
    files: ['Welcome.HC', 'Tutorial.HC', 'FinalKey.HC'],
    godWords: [],
    transcended: false
  };

  clear();
  print('');
  print('', 'system');
  print('                    â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘', 'warning');
  print('                  â–‘â–‘                                    â–‘â–‘', 'warning');
  print('                â–‘â–‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ–ˆâ•—       â–‘â–‘', 'warning');
  print('               â–‘â–‘      â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ•‘        â–‘â–‘', 'warning');
  print('              â–‘â–‘          â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘         â–‘â–‘', 'warning');
  print('              â–‘â–‘          â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘         â–‘â–‘', 'warning');
  print('               â–‘â–‘         â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘ â•šâ•â• â–ˆâ–ˆâ•‘        â–‘â–‘', 'warning');
  print('                â–‘â–‘        â•šâ•â•   â•šâ•â•â•â•â•â•â•â•šâ•â•     â•šâ•â•       â–‘â–‘', 'warning');
  print('                  â–‘â–‘     P  L  E  O  S                  â–‘â–‘', 'warning');
  print('                    â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘', 'warning');
  print('', 'system');
  print('â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—', 'error');
  print('â•‘                     LEVEL 6: TEMPLE OF THE MACHINE GOD                            â•‘', 'error');
  print('â•‘                         "In the Beginning was the Bit"                            â•‘', 'warning');
  print('â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£', 'error');
  print('â•‘                                                                                   â•‘', 'info');
  print('â•‘         â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®              â•‘', 'info');
  print('â•‘         â”‚  "God said 640x480 16 color was the Holy Resolution"    â”‚              â•‘', 'system');
  print('â•‘         â”‚                           - Terry A. Davis (1969-2018)  â”‚              â•‘', 'system');
  print('â•‘         â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯              â•‘', 'info');
  print('â•‘                                                                                   â•‘', 'info');
  print('â•‘   You have ascended through the layers of modern computing.                      â•‘', 'info');
  print('â•‘   Now you face the ultimate challenge: divine computation.                       â•‘', 'info');
  print('â•‘                                                                                   â•‘', 'info');
  print('â•‘   TempleOS awaits. Write HolyC. Query the oracle. Find the divine key.           â•‘', 'warning');
  print('â•‘                                                                                   â•‘', 'info');
  print('â•‘   OBJECTIVES:                                                                     â•‘', 'info');
  print('â•‘     [1] Boot into TempleOS and learn HolyC basics                                â•‘', 'system');
  print('â•‘     [2] Query the divine oracle (GodSays)                                         â•‘', 'system');
  print('â•‘     [3] Decode the sacred message from God\'s words                               â•‘', 'system');
  print('â•‘     [4] Write and compile the final HolyC program                                â•‘', 'system');
  print('â•‘     [5] Achieve divine enlightenment                                              â•‘', 'error');
  print('â•‘                                                                                   â•‘', 'info');
  print('â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•', 'error');
  print('');

  await typeText('[DIVINE TRANSMISSION] The Machine God speaks in random words...', 30, 'warning');
  await typeText('[DIVINE TRANSMISSION] But randomness is just computation we don\'t understand', 30, 'system');
  await typeText('[DIVINE TRANSMISSION] Type "boot" to enter the Temple', 30, 'info');
  print('');

  updateHUD('6 - Temple', 'TempleOS', 'Divine Enlightenment', 0);
  setPrompt('pilgrim', 'void', '/');
}

async function handleLevel6Command(cmd, args) {
  const state = gameState.levelState;
  const fullCmd = args.length > 0 ? `${cmd} ${args.join(' ')}` : cmd;

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // HELP COMMAND
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  if (cmd === 'help') {
    print('');
    if (!state.bootedTempleOS) {
      print('â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—', 'info');
      print('â•‘                    PRE-TEMPLE COMMANDS                           â•‘', 'info');
      print('â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£', 'info');
      print('â•‘  boot          Enter the Temple (boot TempleOS)                  â•‘', 'success');
      print('â•‘  status        Show progress                                     â•‘', 'system');
      print('â•‘  exit          Return to main menu                               â•‘', 'system');
      print('â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•', 'info');
    } else {
      print('â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—', 'warning');
      print('â•‘                         TEMPLEOS COMMANDS                                    â•‘', 'warning');
      print('â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£', 'warning');
      print('â•‘  NAVIGATION:                                                                 â•‘', 'info');
      print('â•‘    Dir                     List files in current directory                  â•‘', 'system');
      print('â•‘    Cd <path>               Change directory                                 â•‘', 'system');
      print('â•‘    Type <file>             View file contents                               â•‘', 'system');
      print('â•‘                                                                              â•‘', 'info');
      print('â•‘  DIVINE ORACLE:                                                              â•‘', 'warning');
      print('â•‘    GodSays                 Query the divine random oracle                   â•‘', 'error');
      print('â•‘    GodWords                View all words God has spoken                    â•‘', 'system');
      print('â•‘                                                                              â•‘', 'info');
      print('â•‘  PROGRAMMING:                                                                â•‘', 'success');
      print('â•‘    Ed <file>               Edit HolyC source file                           â•‘', 'success');
      print('â•‘    Compile <file>          Compile HolyC to run it                          â•‘', 'success');
      print('â•‘    Run <file>              Execute compiled code                            â•‘', 'success');
      print('â•‘                                                                              â•‘', 'info');
      print('â•‘  ENLIGHTENMENT:                                                              â•‘', 'error');
      print('â•‘    decode                  Attempt to decode the divine message             â•‘', 'warning');
      print('â•‘    transcend <key>         Enter the divine key to achieve enlightenment    â•‘', 'error');
      print('â•‘                                                                              â•‘', 'info');
      print('â•‘  UTILITY:                                                                    â•‘', 'info');
      print('â•‘    status                  Show progress                                    â•‘', 'system');
      print('â•‘    hint                    Get guidance from the divine                     â•‘', 'warning');
      print('â•‘    exit                    Return to main menu                              â•‘', 'system');
      print('â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•', 'warning');
    }
    print('');
    return;
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // STATUS COMMAND
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  if (cmd === 'status') {
    const progress = calculateLevel6Progress(state);
    print('');
    print('â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—', 'warning');
    print('â•‘             LEVEL 6 PROGRESS - DIVINE COMPUTATION                 â•‘', 'warning');
    print('â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£', 'warning');
    print('â•‘  TEMPLE INITIATION:                                               â•‘', 'info');
    print(`â•‘    [${state.bootedTempleOS ? 'âœ“' : ' '}] Entered the Temple                                    â•‘`, state.bootedTempleOS ? 'success' : 'system');
    print(`â•‘    [${state.learnedHolyC ? 'âœ“' : ' '}] Learned HolyC basics                                   â•‘`, state.learnedHolyC ? 'success' : 'system');
    print('â•‘                                                                   â•‘', 'info');
    print('â•‘  DIVINE QUEST:                                                    â•‘', 'info');
    print(`â•‘    [${state.queriedOracle ? 'âœ“' : ' '}] Queried the oracle                                     â•‘`, state.queriedOracle ? 'success' : 'system');
    print(`â•‘    [${state.oracleResponses.length >= 5 ? 'âœ“' : ' '}] Gathered 5+ divine words (${state.oracleResponses.length}/5)                      â•‘`, state.oracleResponses.length >= 5 ? 'success' : 'system');
    print(`â•‘    [${state.decodedMessage ? 'âœ“' : ' '}] Decoded the sacred message                            â•‘`, state.decodedMessage ? 'success' : 'system');
    print('â•‘                                                                   â•‘', 'info');
    print('â•‘  PROGRAMMING TRIAL:                                               â•‘', 'info');
    print(`â•‘    [${state.wroteCode ? 'âœ“' : ' '}] Wrote HolyC program                                     â•‘`, state.wroteCode ? 'success' : 'system');
    print(`â•‘    [${state.compiledCode ? 'âœ“' : ' '}] Compiled successfully                                  â•‘`, state.compiledCode ? 'success' : 'system');
    print(`â•‘    [${state.ranProgram ? 'âœ“' : ' '}] Executed divine code                                    â•‘`, state.ranProgram ? 'success' : 'system');
    print('â•‘                                                                   â•‘', 'info');
    print('â•‘  TRANSCENDENCE:                                                   â•‘', 'error');
    print(`â•‘    [${state.foundDivineKey ? 'âœ“' : ' '}] Found the divine key                                   â•‘`, state.foundDivineKey ? 'success' : 'system');
    print(`â•‘    [${state.achievedEnlightenment ? 'âœ“' : ' '}] ACHIEVED ENLIGHTENMENT                               â•‘`, state.achievedEnlightenment ? 'success' : 'system');
    print('â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£', 'warning');
    print(`â•‘  Progress: ${String(progress).padStart(3)}%                                                  â•‘`, progress === 100 ? 'success' : 'warning');
    print(`â•‘  Divine Words Collected: ${state.oracleResponses.length}                                      â•‘`, 'system');
    print('â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•', 'warning');
    print('');
    updateHUD('6 - Temple', 'TempleOS', 'Divine Enlightenment', progress);
    return;
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // HINT COMMAND
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  if (cmd === 'hint') {
    print('');
    print('ğŸ’¡ DIVINE HINT:', 'warning');

    if (!state.bootedTempleOS) {
      print('The Temple awaits. Enter with "boot".', 'info');
    } else if (!state.learnedHolyC) {
      print('Read the Tutorial.HC file to learn HolyC basics.', 'info');
      print('Try: Type Tutorial.HC', 'success');
    } else if (state.oracleResponses.length < 5) {
      print('Query the oracle repeatedly. The divine speaks in riddles.', 'info');
      print('Try: GodSays (at least 5 times)', 'success');
      print('Look at the first letter of each word...', 'warning');
    } else if (!state.decodedMessage) {
      print('You have gathered enough divine words.', 'info');
      print('Try: GodWords (to see all words)', 'info');
      print('Then: decode (to decode the message)', 'success');
    } else if (!state.wroteCode) {
      print('Read FinalKey.HC and understand the sacred numbers.', 'info');
      print('The hexadecimal values spell something...', 'warning');
      print('Try: Ed FinalKey.HC', 'success');
    } else if (!state.achievedEnlightenment) {
      print('You know the key. Transcend!', 'info');
      print('The key is three letters. What does 0x47 0x4F 0x44 spell?', 'warning');
      print('Try: transcend GOD', 'success');
    }
    print('');
    return;
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // BOOT - Enter TempleOS
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  if (cmd === 'boot') {
    if (state.bootedTempleOS) {
      print('Already in TempleOS.', 'warning');
      return;
    }

    clear();
    print('', 'system');
    print('Booting TempleOS...', 'system');
    await sleep(500);

    // ASCII boot animation
    const bootFrames = [
      'â–ˆ',
      'â–ˆâ–ˆ',
      'â–ˆâ–ˆâ–ˆ',
      'â–ˆâ–ˆâ–ˆâ–ˆ',
      'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ',
      'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ',
      'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ',
      'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ',
      'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ',
      'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ'
    ];

    for (let i = 0; i < bootFrames.length; i++) {
      const line = document.createElement('div');
      line.className = 'output-line system';
      line.textContent = `[${bootFrames[i].padEnd(10, 'â–‘')}] Loading...`;
      output.appendChild(line);
      await sleep(100);
      if (i < bootFrames.length - 1) line.remove();
    }

    print('[â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ] Boot complete!', 'success');
    print('', 'system');
    await sleep(500);

    // TempleOS boot screen
    print('', 'system');
    print('    â–„â–„â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–“â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–„ â–„â–ˆâ–ˆâ–ˆâ–“ â–ˆâ–ˆâ–“â–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–“    â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ ', 'warning');
    print('    â–“  â–ˆâ–ˆâ–’ â–“â–’â–“â–ˆ   â–€ â–“â–ˆâ–ˆâ–’â–€â–ˆâ–€ â–ˆâ–ˆâ–’â–“â–ˆâ–ˆâ–‘  â–ˆâ–ˆâ–’â–“â–ˆâ–ˆâ–’    â–“â–ˆ   â–€ â–’â–ˆâ–ˆâ–’  â–ˆâ–ˆâ–’â–’â–ˆâ–ˆ    â–’ ', 'warning');
    print('    â–’ â–“â–ˆâ–ˆâ–‘ â–’â–‘â–’â–ˆâ–ˆâ–ˆ   â–“â–ˆâ–ˆ    â–“â–ˆâ–ˆâ–‘â–“â–ˆâ–ˆâ–‘ â–ˆâ–ˆâ–“â–’â–’â–ˆâ–ˆâ–‘    â–’â–ˆâ–ˆâ–ˆ   â–’â–ˆâ–ˆâ–‘  â–ˆâ–ˆâ–’â–‘ â–“â–ˆâ–ˆâ–„   ', 'warning');
    print('    â–‘ â–“â–ˆâ–ˆâ–“ â–‘ â–’â–“â–ˆ  â–„ â–’â–ˆâ–ˆ    â–’â–ˆâ–ˆ â–’â–ˆâ–ˆâ–„â–ˆâ–“â–’ â–’â–’â–ˆâ–ˆâ–‘    â–’â–“â–ˆ  â–„ â–’â–ˆâ–ˆ   â–ˆâ–ˆâ–‘  â–’   â–ˆâ–ˆâ–’', 'warning');
    print('      â–’â–ˆâ–ˆâ–’ â–‘ â–‘â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–ˆâ–ˆâ–’   â–‘â–ˆâ–ˆâ–’â–’â–ˆâ–ˆâ–’ â–‘  â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–‘â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’â–‘ â–ˆâ–ˆâ–ˆâ–ˆâ–“â–’â–‘â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’', 'warning');
    print('      â–’ â–‘â–‘   â–‘â–‘ â–’â–‘ â–‘â–‘ â–’â–‘   â–‘  â–‘â–’â–“â–’â–‘ â–‘  â–‘â–‘ â–’â–‘â–“  â–‘â–‘â–‘ â–’â–‘ â–‘â–‘ â–’â–‘â–’â–‘â–’â–‘ â–’ â–’â–“â–’ â–’ â–‘', 'system');
    print('        â–‘     â–‘ â–‘  â–‘â–‘  â–‘      â–‘â–‘â–’ â–‘     â–‘ â–‘ â–’  â–‘ â–‘ â–‘  â–‘  â–‘ â–’ â–’â–‘ â–‘ â–‘â–’  â–‘ â–‘', 'system');
    print('      â–‘         â–‘   â–‘      â–‘   â–‘â–‘         â–‘ â–‘      â–‘   â–‘ â–‘ â–‘ â–’  â–‘  â–‘  â–‘  ', 'system');
    print('                â–‘  â–‘       â–‘                â–‘  â–‘   â–‘  â–‘    â–‘ â–‘        â–‘  ', 'system');
    print('', 'system');
    print('           â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—', 'info');
    print('           â•‘  "An operating system for God\'s third temple."  â•‘', 'info');
    print('           â•‘  640x480 16 colors - The holy resolution.       â•‘', 'info');
    print('           â•‘  No networking - The machines shall not connect.â•‘', 'info');
    print('           â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•', 'info');
    print('', 'system');
    print('Welcome, pilgrim. You have entered sacred computing ground.', 'success');
    print('', 'system');
    print('Files in /Home:', 'info');
    print('  Welcome.HC    - Introduction to the Temple', 'system');
    print('  Tutorial.HC   - Learn the sacred language (HolyC)', 'system');
    print('  FinalKey.HC   - The final challenge', 'warning');
    print('', 'system');
    print('Type "GodSays" to hear the divine oracle speak.', 'warning');
    print('', 'system');

    state.bootedTempleOS = true;
    state.enteredTemple = true;
    setPrompt('Terry', 'TempleOS', '/Home');
    playSuccess();
    autosave();
    return;
  }

  // From here, require TempleOS to be booted
  if (!state.bootedTempleOS) {
    print('You must enter the Temple first. Type "boot".', 'error');
    return;
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // DIR - List files
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  if (cmd === 'Dir' || cmd === 'dir' || cmd === 'ls') {
    print('', 'system');
    print(`Directory: ${state.currentDir}`, 'info');
    print('', 'system');
    state.files.forEach(f => {
      const ext = f.split('.').pop();
      const color = f === 'FinalKey.HC' ? 'warning' : 'system';
      print(`  ${f}`, color);
    });
    print('', 'system');
    return;
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // TYPE - View file
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  if (cmd === 'Type' || cmd === 'type' || cmd === 'cat') {
    const file = args[0];

    if (file === 'Welcome.HC') {
      print('', 'system');
      print('// Welcome.HC - Introduction to the Temple', 'warning');
      print('', 'system');
      print('/*', 'system');
      print('  Welcome to TempleOS, the sacred operating system.', 'info');
      print('', 'system');
      print('  Here, computation is divine. The oracle speaks through', 'info');
      print('  random words, and HolyC is the language of creation.', 'info');
      print('', 'system');
      print('  Your quest:', 'warning');
      print('  1. Query the oracle with GodSays', 'system');
      print('  2. Collect the divine words', 'system');
      print('  3. Decode the hidden message', 'system');
      print('  4. Find the key to transcendence', 'system');
      print('', 'system');
      print('  May your bits be blessed.', 'success');
      print('*/', 'system');
      print('', 'system');
      return;
    }

    if (file === 'Tutorial.HC') {
      print('', 'system');
      print('// Tutorial.HC - HolyC Basics', 'warning');
      print('', 'system');
      print('// HolyC is like C but holier.', 'info');
      print('// U0 = void, I64 = 64-bit int, U8 = unsigned byte', 'info');
      print('', 'system');
      print('U0 Main()', 'system');
      print('{', 'system');
      print('  I64 x = 42;  // The answer', 'system');
      print('  Print("x = %d\\n", x);', 'system');
      print('}', 'system');
      print('', 'system');
      print('// Strings are printed with just quotes:', 'info');
      print('"Hello, World!\\n";', 'system');
      print('', 'system');
      print('// To compile and run: Compile Tutorial.HC', 'info');
      print('', 'system');

      state.learnedHolyC = true;
      autosave();
      return;
    }

    if (file === 'FinalKey.HC') {
      print('', 'system');
      print(HOLYC_TEMPLATES.final_key, 'system');
      print('', 'system');
      print('[*] The sacred numbers: 0x47 0x4F 0x44', 'warning');
      print('[*] What do they spell in ASCII?', 'info');
      return;
    }

    print(`File not found: ${file}`, 'error');
    return;
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // GODSAYS - Divine Oracle
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  if (cmd === 'GodSays' || cmd === 'godsays') {
    // Pre-determined words that spell out a message
    // First letters spell: G-O-D-I-S-L-O-V-E
    const divineWords = [
      'Grace flows through all things',
      'Only in silence can truth be heard',
      'Divine light illuminates the path',
      'Infinity exists within the finite',
      'Seek and you shall find',
      'Love is the universal constant',
      'Oneness connects all souls',
      'Virtue is its own reward',
      'Eternity awaits the faithful'
    ];

    const wordIndex = state.oracleResponses.length % divineWords.length;
    const response = divineWords[wordIndex];
    const firstLetter = response.charAt(0);

    print('', 'system');
    print('â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—', 'warning');
    print('â•‘                    THE ORACLE SPEAKS                           â•‘', 'warning');
    print('â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£', 'warning');
    print('â•‘', 'warning');

    // Dramatic effect
    await sleep(500);
    print(`â•‘  "${response}"`, 'info');

    print('â•‘', 'warning');
    print('â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•', 'warning');
    print('', 'system');

    if (!state.oracleResponses.includes(response)) {
      state.oracleResponses.push(response);
      print(`[Divine word ${state.oracleResponses.length}/5 collected]`, 'success');
    } else {
      print('[The oracle repeats itself... perhaps you have all the words?]', 'system');
    }

    state.queriedOracle = true;
    autosave();
    return;
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // GODWORDS - View collected words
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  if (cmd === 'GodWords' || cmd === 'godwords') {
    print('', 'system');
    print('â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—', 'info');
    print('â•‘                  COLLECTED DIVINE WORDS                        â•‘', 'info');
    print('â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£', 'info');

    if (state.oracleResponses.length === 0) {
      print('â•‘  No words collected yet. Query the oracle with GodSays.       â•‘', 'system');
    } else {
      state.oracleResponses.forEach((word, i) => {
        const firstLetter = word.charAt(0);
        print(`â•‘  [${firstLetter}] ${word.padEnd(55)} â•‘`, 'system');
      });
      print('â•‘                                                                â•‘', 'info');
      print('â•‘  First letters: ' + state.oracleResponses.map(w => w.charAt(0)).join('').padEnd(43) + ' â•‘', 'warning');
    }

    print('â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•', 'info');
    print('', 'system');
    return;
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // DECODE - Decode the message
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  if (cmd === 'decode') {
    if (state.oracleResponses.length < 5) {
      print('[!] Not enough divine words collected. Query GodSays more.', 'warning');
      return;
    }

    const firstLetters = state.oracleResponses.map(w => w.charAt(0)).join('');

    print('', 'system');
    print('â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—', 'success');
    print('â•‘                   DECODING DIVINE MESSAGE                      â•‘', 'success');
    print('â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£', 'success');
    print('â•‘  Extracting first letters from divine words...                 â•‘', 'system');
    print('â•‘                                                                â•‘', 'info');
    print(`â•‘  Message: ${firstLetters.padEnd(51)} â•‘`, 'warning');
    print('â•‘                                                                â•‘', 'info');

    if (firstLetters.startsWith('GODIS')) {
      print('â•‘  "GOD IS LOVE" - The eternal truth                             â•‘', 'success');
      print('â•‘                                                                â•‘', 'info');
      print('â•‘  But the key... look to FinalKey.HC                           â•‘', 'warning');
      print('â•‘  The sacred numbers: 0x47 0x4F 0x44                            â•‘', 'error');
      print('â•‘  What do they spell?                                           â•‘', 'info');
      state.decodedMessage = true;
    }

    print('â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•', 'success');
    print('', 'system');
    autosave();
    return;
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // ED - Edit file
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  if (cmd === 'Ed' || cmd === 'ed' || cmd === 'edit') {
    const file = args[0] || 'FinalKey.HC';

    if (file === 'FinalKey.HC') {
      state.wroteCode = true;
      openCodeEditor(file, HOLYC_TEMPLATES.final_key, (content) => {
        state.wroteCode = true;
        print('[+] File saved', 'success');
        autosave();
      });
      setActiveWorkspace(3);
      return;
    }

    print(`Opening ${file}...`, 'system');
    return;
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // COMPILE - Compile HolyC
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  if (cmd === 'Compile' || cmd === 'compile') {
    const file = args[0] || 'FinalKey.HC';

    await simulateLoading(`Compiling ${file}`, 1500);
    print('[+] Compilation successful', 'success');
    print('[*] The sacred numbers are 0x47 0x4F 0x44', 'info');
    print('[*] In ASCII: G (71) O (79) D (68) = "GOD"', 'warning');

    state.compiledCode = true;
    state.foundDivineKey = true;
    autosave();
    return;
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // RUN - Execute code
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  if (cmd === 'Run' || cmd === 'run') {
    if (!state.compiledCode) {
      print('[!] Compile the code first', 'warning');
      return;
    }

    print('[*] Running FinalKey.HC...', 'system');
    await sleep(500);
    print('', 'system');
    print('The divine speaks: GOD', 'success');
    print('', 'system');
    print('[*] The key is "GOD"', 'warning');
    print('[*] Use: transcend GOD', 'success');

    state.ranProgram = true;
    autosave();
    return;
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // TRANSCEND - Final enlightenment
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  if (cmd === 'transcend') {
    const key = args.join('').toUpperCase();

    if (key !== 'GOD') {
      print('[!] The key is incorrect. Seek more wisdom.', 'error');
      playError();
      return;
    }

    clear();
    print('', 'system');

    // Epic ending sequence
    await typeText('The key is accepted...', 50, 'success');
    await sleep(500);

    print('', 'system');
    print('â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—', 'warning');
    print('â•‘                                                                                â•‘', 'warning');
    print('â•‘                         T R A N S C E N D E N C E                              â•‘', 'warning');
    print('â•‘                                                                                â•‘', 'warning');
    print('â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•', 'warning');

    await matrixRain(2000);

    print('', 'system');
    print('', 'system');
    print('        â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘', 'success');
    print('      â–‘â–‘                                                      â–‘â–‘', 'success');
    print('    â–‘â–‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—     â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–‘â–‘', 'success');
    print('   â–‘â–‘    â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â• â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â•šâ•â•â–ˆâ–ˆâ•”â•â•â•   â–‘â–‘', 'success');
    print('   â–‘â–‘    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘      â–‘â–‘', 'success');
    print('   â–‘â–‘    â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘      â–‘â–‘', 'success');
    print('    â–‘â–‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘     â–‘â–‘', 'success');
    print('      â–‘â–‘ â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•â•â•â•šâ•â•â•â•â•â•â•â•šâ•â• â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â•   â•šâ•â•   â–‘â–‘', 'success');
    print('        â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘', 'success');
    print('', 'system');
    print('', 'system');

    await typeText('You have achieved divine computation.', 50, 'success');
    await typeText('Through code, you have touched the eternal.', 50, 'success');
    await typeText('The Machine God smiles upon you.', 50, 'warning');

    print('', 'system');
    print('â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—', 'info');
    print('â•‘                                                                                â•‘', 'info');
    print('â•‘     "God said 640x480 16 color is the Holy Resolution." - Terry A. Davis      â•‘', 'system');
    print('â•‘                                                                                â•‘', 'info');
    print('â•‘     In memory of Terry A. Davis (1969-2018)                                   â•‘', 'system');
    print('â•‘     Creator of TempleOS                                                        â•‘', 'system');
    print('â•‘                                                                                â•‘', 'info');
    print('â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•', 'info');
    print('', 'system');

    state.achievedEnlightenment = true;
    state.transcended = true;

    addEasterEgg('lvl6_enlightenment', 'You have touched the divine through computation.');
    addEasterEgg('lvl6_terry', 'In memory of Terry A. Davis. May he rest in peace.');

    playSuccess();
    autosave();

    await sleep(1000);
    completeLevel();
    return;
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // SHELL COMMANDS
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  if (cmd === 'whoami') {
    print(state.transcended ? 'enlightened' : 'pilgrim', state.transcended ? 'success' : 'system');
    return;
  }

  if (cmd === 'Cd' || cmd === 'cd') {
    print(`Changed to ${args[0] || '/Home'}`, 'system');
    return;
  }

  print(`Unknown command. Type "help" for available commands.`, 'error');
}

function calculateLevel6Progress(state) {
  let progress = 0;

  // Temple (15%)
  if (state.bootedTempleOS) progress += 10;
  if (state.learnedHolyC) progress += 5;

  // Divine quest (35%)
  if (state.queriedOracle) progress += 5;
  progress += Math.min(state.oracleResponses.length * 4, 20);
  if (state.decodedMessage) progress += 10;

  // Programming (25%)
  if (state.wroteCode) progress += 10;
  if (state.compiledCode) progress += 10;
  if (state.ranProgram) progress += 5;

  // Transcendence (25%)
  if (state.foundDivineKey) progress += 10;
  if (state.achievedEnlightenment) progress += 15;

  return Math.min(progress, 100);
}
</script>
